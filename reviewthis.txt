I changed this code so that it works.
Now I modified it again.
Another modification due to errors...
